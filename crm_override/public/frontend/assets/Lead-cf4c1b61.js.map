{"version":3,"file":"Lead-cf4c1b61.js","sources":["../../../../frontend/src/pages/Lead.vue"],"sourcesContent":["<template>\n  <LayoutHeader v-if=\"lead.data\">\n    <template #left-header>\n      <Breadcrumbs :items=\"breadcrumbs\">\n        <template #prefix=\"{ item }\">\n          <Icon v-if=\"item.icon\" :icon=\"item.icon\" class=\"mr-2 h-4\" />\n        </template>\n      </Breadcrumbs>\n    </template>\n    <template #right-header>\n      <CustomActions\n        v-if=\"lead.data._customActions\"\n        :actions=\"lead.data._customActions\"\n      />\n      <component :is=\"lead.data._assignedTo?.length == 1 ? 'Button' : 'div'\">\n        <MultipleAvatar\n          :avatars=\"lead.data._assignedTo\"\n          @click=\"showAssignmentModal = true\"\n        />\n      </component>\n      <Dropdown :options=\"statusOptions('lead', updateField, lead.data._customStatuses)\">\n        <template #default=\"{ open }\">\n          <Button\n            :label=\"lead.data.status\"\n            :class=\"getLeadStatus(lead.data.status).colorClass\"\n          >\n            <template #prefix>\n              <IndicatorIcon />\n            </template>\n            <template #suffix>\n              <FeatherIcon\n                :name=\"open ? 'chevron-up' : 'chevron-down'\"\n                class=\"h-4\"\n              />\n            </template>\n          </Button>\n        </template>\n      </Dropdown>\n      <Button\n        :label=\"__('Convert to Deal')\"\n        variant=\"solid\"\n        @click=\"showConvertToDealModal = true\"\n      />\n    </template>\n  </LayoutHeader>\n  <div v-if=\"lead?.data\" class=\"flex h-full overflow-hidden\">\n    <Tabs v-model=\"tabIndex\" v-slot=\"{ tab }\" :tabs=\"tabs\">\n      <Activities\n        ref=\"activities\"\n        doctype=\"CRM Lead\"\n        :title=\"tab.name\"\n        :tabs=\"tabs\"\n        v-model:reload=\"reload\"\n        v-model:tabIndex=\"tabIndex\"\n        v-model=\"lead\"\n      />\n    </Tabs>\n    <Resizer class=\"flex flex-col justify-between border-l\" side=\"right\">\n      <div\n        class=\"flex h-10.5 cursor-copy items-center border-b px-5 py-2.5 text-lg font-medium\"\n        @click=\"copyToClipboard(lead.data.name)\"\n      >\n        {{ __(lead.data.name) }}\n      </div>\n      <FileUploader\n        @success=\"(file) => updateField('image', file.file_url)\"\n        :validateFile=\"validateFile\"\n      >\n        <template #default=\"{ openFileSelector, error }\">\n          <div class=\"flex items-center justify-start gap-5 border-b p-5\">\n            <div class=\"group relative size-12\">\n              <Avatar\n                size=\"3xl\"\n                class=\"size-12\"\n                :label=\"lead.data.first_name || __('Untitled')\"\n                :image=\"lead.data.image\"\n              />\n              <component\n                :is=\"lead.data.image ? Dropdown : 'div'\"\n                v-bind=\"\n                  lead.data.image\n                    ? {\n                        options: [\n                          {\n                            icon: 'upload',\n                            label: lead.data.image\n                              ? __('Change image')\n                              : __('Upload image'),\n                            onClick: openFileSelector,\n                          },\n                          {\n                            icon: 'trash-2',\n                            label: __('Remove image'),\n                            onClick: () => updateField('image', ''),\n                          },\n                        ],\n                      }\n                    : { onClick: openFileSelector }\n                \"\n                class=\"!absolute bottom-0 left-0 right-0\"\n              >\n                <div\n                  class=\"z-1 absolute bottom-0.5 left-0 right-0.5 flex h-9 cursor-pointer items-center justify-center rounded-b-full bg-black bg-opacity-40 pt-3 opacity-0 duration-300 ease-in-out group-hover:opacity-100\"\n                  style=\"\n                    -webkit-clip-path: inset(12px 0 0 0);\n                    clip-path: inset(12px 0 0 0);\n                  \"\n                >\n                  <CameraIcon class=\"size-4 cursor-pointer text-white\" />\n                </div>\n              </component>\n            </div>\n            <div class=\"flex flex-col gap-2.5 truncate\">\n              <Tooltip :text=\"lead.data.lead_name || __('Set first name')\">\n                <div class=\"truncate text-2xl font-medium\">\n                  {{ lead.data.lead_name || __('Untitled') }}\n                </div>\n              </Tooltip>\n              <div class=\"flex gap-1.5\">\n                <Tooltip v-if=\"callEnabled\" :text=\"__('Make a call')\">\n                  <Button\n                    class=\"h-7 w-7\"\n                    @click=\"\n                      () =>\n                        lead.data.mobile_no\n                          ? makeCall(lead.data.mobile_no)\n                          : errorMessage(__('No phone number set'))\n                    \"\n                  >\n                    <PhoneIcon class=\"h-4 w-4\" />\n                  </Button>\n                </Tooltip>\n                <Tooltip :text=\"__('Send an email')\">\n                  <Button class=\"h-7 w-7\">\n                    <Email2Icon\n                      class=\"h-4 w-4\"\n                      @click=\"\n                        lead.data.email\n                          ? openEmailBox()\n                          : errorMessage(__('No email set'))\n                      \"\n                    />\n                  </Button>\n                </Tooltip>\n                <Tooltip :text=\"__('Go to website')\">\n                  <Button class=\"h-7 w-7\">\n                    <LinkIcon\n                      class=\"h-4 w-4\"\n                      @click=\"\n                        lead.data.website\n                          ? openWebsite(lead.data.website)\n                          : errorMessage(__('No website set'))\n                      \"\n                    />\n                  </Button>\n                </Tooltip>\n              </div>\n              <ErrorMessage :message=\"__(error)\" />\n            </div>\n          </div>\n        </template>\n      </FileUploader>\n      <SLASection\n        v-if=\"lead.data.sla_status\"\n        v-model=\"lead.data\"\n        @updateField=\"updateField\"\n      />\n      <div\n        v-if=\"fieldsLayout.data\"\n        class=\"flex flex-1 flex-col justify-between overflow-hidden\"\n      >\n        <div class=\"flex flex-col overflow-y-auto\">\n          <div\n            v-for=\"(section, i) in fieldsLayout.data\"\n            :key=\"section.label\"\n            class=\"flex flex-col p-3\"\n            :class=\"{ 'border-b': i !== fieldsLayout.data.length - 1 }\"\n          >\n            <Section :is-opened=\"section.opened\" :label=\"section.label\">\n              <SectionFields\n                :fields=\"section.fields\"\n                v-model=\"lead.data\"\n                @update=\"updateField\"\n              />\n              <template v-if=\"i == 0 && isManager()\" #actions>\n                <Button\n                  variant=\"ghost\"\n                  class=\"w-7 mr-2\"\n                  @click=\"showSidePanelModal = true\"\n                >\n                  <EditIcon class=\"h-4 w-4\" />\n                </Button>\n              </template>\n            </Section>\n          </div>\n        </div>\n      </div>\n    </Resizer>\n  </div>\n  <AssignmentModal\n    v-if=\"showAssignmentModal\"\n    v-model=\"showAssignmentModal\"\n    v-model:assignees=\"lead.data._assignedTo\"\n    :doc=\"lead.data\"\n    doctype=\"CRM Lead\"\n  />\n  <Dialog\n    v-model=\"showConvertToDealModal\"\n    :options=\"{\n      title: __('Convert to Deal'),\n      size: 'xl',\n      actions: [\n        {\n          label: __('Convert'),\n          variant: 'solid',\n          onClick: convertToDeal,\n        },\n      ],\n    }\"\n  >\n    <template #body-content>\n      <div class=\"mb-4 flex items-center gap-2 text-gray-600\">\n        <OrganizationsIcon class=\"h-4 w-4\" />\n        <label class=\"block text-base\">{{ __('Organization') }}</label>\n      </div>\n      <div class=\"ml-6\">\n        <div class=\"flex items-center justify-between text-base\">\n          <div>{{ __('Choose Existing') }}</div>\n          <Switch v-model=\"existingOrganizationChecked\" />\n        </div>\n        <Link\n          v-if=\"existingOrganizationChecked\"\n          class=\"form-control mt-2.5\"\n          variant=\"outline\"\n          size=\"md\"\n          :value=\"existingOrganization\"\n          doctype=\"CRM Organization\"\n          @change=\"(data) => (existingOrganization = data)\"\n        />\n        <div v-else class=\"mt-2.5 text-base\">\n          {{\n            __(\n              'New organization will be created based on the data in details section',\n            )\n          }}\n        </div>\n      </div>\n\n      <div class=\"mb-4 mt-6 flex items-center gap-2 text-gray-600\">\n        <ContactsIcon class=\"h-4 w-4\" />\n        <label class=\"block text-base\">{{ __('Contact') }}</label>\n      </div>\n      <div class=\"ml-6\">\n        <div class=\"flex items-center justify-between text-base\">\n          <div>{{ __('Choose Existing') }}</div>\n          <Switch v-model=\"existingContactChecked\" />\n        </div>\n        <Link\n          v-if=\"existingContactChecked\"\n          class=\"form-control mt-2.5\"\n          variant=\"outline\"\n          size=\"md\"\n          :value=\"existingContact\"\n          doctype=\"Contact\"\n          @change=\"(data) => (existingContact = data)\"\n        />\n        <div v-else class=\"mt-2.5 text-base\">\n          {{ __(\"New contact will be created based on the person's details\") }}\n        </div>\n      </div>\n    </template>\n  </Dialog>\n  <SidePanelModal\n    v-if=\"showSidePanelModal\"\n    v-model=\"showSidePanelModal\"\n    @reload=\"() => fieldsLayout.reload()\"\n  />\n</template>\n<script setup>\nimport Icon from '@/components/Icon.vue'\nimport Resizer from '@/components/Resizer.vue'\nimport EditIcon from '@/components/Icons/EditIcon.vue'\nimport ActivityIcon from '@/components/Icons/ActivityIcon.vue'\nimport EmailIcon from '@/components/Icons/EmailIcon.vue'\nimport Email2Icon from '@/components/Icons/Email2Icon.vue'\nimport CommentIcon from '@/components/Icons/CommentIcon.vue'\nimport PhoneIcon from '@/components/Icons/PhoneIcon.vue'\nimport TaskIcon from '@/components/Icons/TaskIcon.vue'\nimport NoteIcon from '@/components/Icons/NoteIcon.vue'\nimport WhatsAppIcon from '@/components/Icons/WhatsAppIcon.vue'\nimport IndicatorIcon from '@/components/Icons/IndicatorIcon.vue'\nimport CameraIcon from '@/components/Icons/CameraIcon.vue'\nimport LinkIcon from '@/components/Icons/LinkIcon.vue'\nimport OrganizationsIcon from '@/components/Icons/OrganizationsIcon.vue'\nimport ContactsIcon from '@/components/Icons/ContactsIcon.vue'\nimport LayoutHeader from '@/components/LayoutHeader.vue'\nimport Activities from '@/components/Activities/Activities.vue'\nimport AssignmentModal from '@/components/Modals/AssignmentModal.vue'\nimport SidePanelModal from '@/components/Settings/SidePanelModal.vue'\nimport MultipleAvatar from '@/components/MultipleAvatar.vue'\nimport Link from '@/components/Controls/Link.vue'\nimport Section from '@/components/Section.vue'\nimport SectionFields from '@/components/SectionFields.vue'\nimport SLASection from '@/components/SLASection.vue'\nimport CustomActions from '@/components/CustomActions.vue'\nimport {\n  openWebsite,\n  createToast,\n  setupAssignees,\n  setupCustomActions,\n  setupCustomStatuses,\n  errorMessage,\n  copyToClipboard,\n} from '@/utils'\nimport { getView } from '@/utils/view'\nimport { globalStore } from '@/stores/global'\nimport { contactsStore } from '@/stores/contacts'\nimport { organizationsStore } from '@/stores/organizations'\nimport { statusesStore } from '@/stores/statuses'\nimport { usersStore } from '@/stores/users'\nimport { whatsappEnabled, callEnabled } from '@/composables/settings'\nimport { capture } from '@/telemetry'\nimport {\n  createResource,\n  FileUploader,\n  Dropdown,\n  Tooltip,\n  Avatar,\n  Tabs,\n  Switch,\n  Breadcrumbs,\n  call,\n  usePageMeta,\n} from 'frappe-ui'\nimport { ref, computed, onMounted, watch } from 'vue'\nimport { useRouter, useRoute } from 'vue-router'\n\nconst { $dialog, makeCall } = globalStore()\nconst { getContactByName, contacts } = contactsStore()\nconst { organizations } = organizationsStore()\nconst { statusOptions, getLeadStatus } = statusesStore()\nconst { isManager } = usersStore()\nconst route = useRoute()\nconst router = useRouter()\n\nconst props = defineProps({\n  leadId: {\n    type: String,\n    required: true,\n  },\n})\n\nconst lead = createResource({\n  url: 'crm.fcrm.doctype.crm_lead.api.get_lead',\n  params: { name: props.leadId },\n  cache: ['lead', props.leadId],\n  onSuccess: (data) => {\n    let obj = {\n      doc: data,\n      $dialog,\n      router,\n      updateField,\n      createToast,\n      deleteDoc: deleteLead,\n      call,\n    }\n    setupAssignees(data)\n    setupCustomStatuses(data, obj)\n    setupCustomActions(data, obj)\n  },\n})\n\nonMounted(() => {\n  if (lead.data) return\n  lead.fetch()\n})\n\nconst reload = ref(false)\nconst showAssignmentModal = ref(false)\nconst showSidePanelModal = ref(false)\n\nfunction updateLead(fieldname, value, callback) {\n  value = Array.isArray(fieldname) ? '' : value\n\n  if (!Array.isArray(fieldname) && validateRequired(fieldname, value)) return\n\n  createResource({\n    url: 'frappe.client.set_value',\n    params: {\n      doctype: 'CRM Lead',\n      name: props.leadId,\n      fieldname,\n      value,\n    },\n    auto: true,\n    onSuccess: () => {\n      lead.reload()\n      reload.value = true\n      createToast({\n        title: __('Lead updated'),\n        icon: 'check',\n        iconClasses: 'text-green-600',\n      })\n      callback?.()\n    },\n    onError: (err) => {\n      createToast({\n        title: __('Error updating lead'),\n        text: __(err.messages?.[0]),\n        icon: 'x',\n        iconClasses: 'text-red-600',\n      })\n    },\n  })\n}\n\nfunction validateRequired(fieldname, value) {\n  let meta = lead.data.fields_meta || {}\n  if (meta[fieldname]?.reqd && !value) {\n    createToast({\n      title: __('Error Updating Lead'),\n      text: __('{0} is a required field', [meta[fieldname].label]),\n      icon: 'x',\n      iconClasses: 'text-red-600',\n    })\n    return true\n  }\n  return false\n}\n\nconst breadcrumbs = computed(() => {\n  let items = [{ label: __('Leads'), route: { name: 'Leads' } }]\n\n  if (route.query.view || route.query.viewType) {\n    let view = getView(route.query.view, route.query.viewType, 'CRM Lead')\n    if (view) {\n      items.push({\n        label: __(view.label),\n        icon: view.icon,\n        route: {\n          name: 'Leads',\n          params: { viewType: route.query.viewType },\n          query: { view: route.query.view },\n        },\n      })\n    }\n  }\n\n  items.push({\n    label: lead.data.lead_name || __('Untitled'),\n    route: { name: 'Lead', params: { leadId: lead.data.name } },\n  })\n  return items\n})\n\nusePageMeta(() => {\n  return {\n    title: lead.data?.lead_name || lead.data?.name,\n  }\n})\n\nconst tabIndex = ref(0)\n\nconst tabs = computed(() => {\n  let tabOptions = [\n    {\n      name: 'Activity',\n      label: __('Activity'),\n      icon: ActivityIcon,\n    },\n    {\n      name: 'Emails',\n      label: __('Emails'),\n      icon: EmailIcon,\n    },\n    {\n      name: 'Comments',\n      label: __('Comments'),\n      icon: CommentIcon,\n    },\n    {\n      name: 'Calls',\n      label: __('Calls'),\n      icon: PhoneIcon,\n      condition: () => callEnabled.value,\n    },\n    {\n      name: 'Tasks',\n      label: __('Tasks'),\n      icon: TaskIcon,\n    },\n    {\n      name: 'Notes',\n      label: __('Notes'),\n      icon: NoteIcon,\n    },\n    {\n      name: 'WhatsApp',\n      label: __('WhatsApp'),\n      icon: WhatsAppIcon,\n      condition: () => whatsappEnabled.value,\n    },\n  ]\n  return tabOptions.filter((tab) => (tab.condition ? tab.condition() : true))\n})\n\nwatch(tabs, (value) => {\n  if (value && route.params.tabName) {\n    let index = value.findIndex(\n      (tab) => tab.name.toLowerCase() === route.params.tabName.toLowerCase(),\n    )\n    if (index !== -1) {\n      tabIndex.value = index\n    }\n  }\n})\n\nfunction validateFile(file) {\n  let extn = file.name.split('.').pop().toLowerCase()\n  if (!['png', 'jpg', 'jpeg'].includes(extn)) {\n    return __('Only PNG and JPG images are allowed')\n  }\n}\n\nconst fieldsLayout = createResource({\n  url: 'crm.api.doc.get_sidebar_fields',\n  cache: ['fieldsLayout', props.leadId],\n  params: { doctype: 'CRM Lead', name: props.leadId },\n  auto: true,\n})\n\nfunction updateField(name, value, callback) {\n  updateLead(name, value, () => {\n    lead.data[name] = value\n    callback?.()\n  })\n}\n\nasync function deleteLead(name) {\n  await call('frappe.client.delete', {\n    doctype: 'CRM Lead',\n    name,\n  })\n  router.push({ name: 'Leads' })\n}\n\n// Convert to Deal\nconst showConvertToDealModal = ref(false)\nconst existingContactChecked = ref(false)\nconst existingOrganizationChecked = ref(false)\n\nconst existingContact = ref('')\nconst existingOrganization = ref('')\n\nasync function convertToDeal(updated) {\n  let valueUpdated = false\n\n  if (existingContactChecked.value && !existingContact.value) {\n    createToast({\n      title: __('Error'),\n      text: __('Please select an existing contact'),\n      icon: 'x',\n      iconClasses: 'text-red-600',\n    })\n    return\n  }\n\n  if (existingOrganizationChecked.value && !existingOrganization.value) {\n    createToast({\n      title: __('Error'),\n      text: __('Please select an existing organization'),\n      icon: 'x',\n      iconClasses: 'text-red-600',\n    })\n    return\n  }\n\n  if (existingContactChecked.value && existingContact.value) {\n    lead.data.salutation = getContactByName(existingContact.value).salutation\n    lead.data.first_name = getContactByName(existingContact.value).first_name\n    lead.data.last_name = getContactByName(existingContact.value).last_name\n    lead.data.email_id = getContactByName(existingContact.value).email_id\n    lead.data.mobile_no = getContactByName(existingContact.value).mobile_no\n    existingContactChecked.value = false\n    valueUpdated = true\n  }\n\n  if (existingOrganizationChecked.value && existingOrganization.value) {\n    lead.data.organization = existingOrganization.value\n    existingOrganizationChecked.value = false\n    valueUpdated = true\n  }\n\n  if (valueUpdated) {\n    updateLead(\n      {\n        salutation: lead.data.salutation,\n        first_name: lead.data.first_name,\n        last_name: lead.data.last_name,\n        email_id: lead.data.email_id,\n        mobile_no: lead.data.mobile_no,\n        organization: lead.data.organization,\n      },\n      '',\n      () => convertToDeal(true),\n    )\n    showConvertToDealModal.value = false\n  } else {\n    let deal = await call(\n      'crm.fcrm.doctype.crm_lead.crm_lead.convert_to_deal',\n      {\n        lead: lead.data.name,\n      },\n    )\n    if (deal) {\n      capture('convert_lead_to_deal')\n      if (updated) {\n        await organizations.reload()\n        await contacts.reload()\n      }\n      router.push({ name: 'Deal', params: { dealId: deal } })\n    }\n  }\n}\n\nconst activities = ref(null)\n\nfunction openEmailBox() {\n  activities.value.emailBox.show = true\n}\n</script>\n"],"names":["$dialog","makeCall","globalStore","getContactByName","contacts","contactsStore","organizations","organizationsStore","statusOptions","getLeadStatus","statusesStore","isManager","usersStore","route","useRoute","router","useRouter","props","__props","lead","createResource","data","obj","updateField","createToast","deleteLead","call","setupAssignees","setupCustomStatuses","setupCustomActions","onMounted","reload","ref","showAssignmentModal","showSidePanelModal","updateLead","fieldname","value","callback","validateRequired","err","_a","meta","breadcrumbs","computed","items","view","getView","usePageMeta","_b","tabIndex","tabs","ActivityIcon","EmailIcon","CommentIcon","PhoneIcon","callEnabled","TaskIcon","NoteIcon","WhatsAppIcon","whatsappEnabled","tab","watch","index","validateFile","file","extn","fieldsLayout","name","showConvertToDealModal","existingContactChecked","existingOrganizationChecked","existingContact","existingOrganization","convertToDeal","updated","valueUpdated","deal","capture","activities","openEmailBox"],"mappings":"guGAiVA,KAAM,CAAE,QAAAA,GAAS,SAAAC,EAAU,EAAGC,GAAa,EACrC,CAAE,iBAAAC,EAAkB,SAAAC,EAAU,EAAGC,GAAe,EAChD,CAAE,cAAAC,EAAe,EAAGC,GAAoB,EACxC,CAAE,cAAAC,GAAe,cAAAC,EAAe,EAAGC,GAAe,EAClD,CAAE,UAAAC,EAAW,EAAGC,GAAY,EAC5BC,EAAQC,GAAU,EAClBC,EAASC,GAAW,EAEpBC,EAAQC,GAORC,EAAOC,EAAe,CAC1B,IAAK,yCACL,OAAQ,CAAE,KAAMH,EAAM,MAAQ,EAC9B,MAAO,CAAC,OAAQA,EAAM,MAAM,EAC5B,UAAYI,GAAS,CACnB,IAAIC,EAAM,CACR,IAAKD,EACL,QAAArB,GACA,OAAAe,EACA,YAAAQ,EACA,YAAAC,EACA,UAAWC,GACX,KAAAC,CACD,EACDC,GAAeN,CAAI,EACnBO,GAAoBP,EAAMC,CAAG,EAC7BO,GAAmBR,EAAMC,CAAG,CAC7B,CACH,CAAC,EAEDQ,GAAU,IAAM,CACVX,EAAK,MACTA,EAAK,MAAO,CACd,CAAC,EAED,MAAMY,EAASC,EAAI,EAAK,EAClBC,EAAsBD,EAAI,EAAK,EAC/BE,EAAqBF,EAAI,EAAK,EAEpC,SAASG,EAAWC,EAAWC,EAAOC,EAAU,CAC9CD,EAAQ,MAAM,QAAQD,CAAS,EAAI,GAAKC,EAEpC,GAAC,MAAM,QAAQD,CAAS,GAAKG,GAAiBH,EAAWC,CAAK,IAElEjB,EAAe,CACb,IAAK,0BACL,OAAQ,CACN,QAAS,WACT,KAAMH,EAAM,OACZ,UAAAmB,EACA,MAAAC,CACD,EACD,KAAM,GACN,UAAW,IAAM,CACflB,EAAK,OAAQ,EACbY,EAAO,MAAQ,GACfP,EAAY,CACV,MAAO,GAAG,cAAc,EACxB,KAAM,QACN,YAAa,gBACrB,CAAO,EACDc,GAAA,MAAAA,GACD,EACD,QAAUE,GAAQ,OAChBhB,EAAY,CACV,MAAO,GAAG,qBAAqB,EAC/B,KAAM,IAAGiB,EAAAD,EAAI,WAAJ,YAAAC,EAAe,EAAE,EAC1B,KAAM,IACN,YAAa,cACrB,CAAO,CACF,CACL,CAAG,CACH,CAEA,SAASF,GAAiBH,EAAWC,EAAO,OAC1C,IAAIK,EAAOvB,EAAK,KAAK,aAAe,CAAE,EACtC,OAAIsB,EAAAC,EAAKN,CAAS,IAAd,MAAAK,EAAiB,MAAQ,CAACJ,GAC5Bb,EAAY,CACV,MAAO,GAAG,qBAAqB,EAC/B,KAAM,GAAG,0BAA2B,CAACkB,EAAKN,CAAS,EAAE,KAAK,CAAC,EAC3D,KAAM,IACN,YAAa,cACnB,CAAK,EACM,IAEF,EACT,CAEA,MAAMO,GAAcC,EAAS,IAAM,CACjC,IAAIC,EAAQ,CAAC,CAAE,MAAO,GAAG,OAAO,EAAG,MAAO,CAAE,KAAM,OAAO,EAAI,EAE7D,GAAIhC,EAAM,MAAM,MAAQA,EAAM,MAAM,SAAU,CAC5C,IAAIiC,EAAOC,GAAQlC,EAAM,MAAM,KAAMA,EAAM,MAAM,SAAU,UAAU,EACjEiC,GACFD,EAAM,KAAK,CACT,MAAO,GAAGC,EAAK,KAAK,EACpB,KAAMA,EAAK,KACX,MAAO,CACL,KAAM,QACN,OAAQ,CAAE,SAAUjC,EAAM,MAAM,QAAU,EAC1C,MAAO,CAAE,KAAMA,EAAM,MAAM,IAAM,CAClC,CACT,CAAO,CAEJ,CAED,OAAAgC,EAAM,KAAK,CACT,MAAO1B,EAAK,KAAK,WAAa,GAAG,UAAU,EAC3C,MAAO,CAAE,KAAM,OAAQ,OAAQ,CAAE,OAAQA,EAAK,KAAK,KAAQ,CAC/D,CAAG,EACM0B,CACT,CAAC,EAEDG,GAAY,IAAM,SAChB,MAAO,CACL,QAAOP,EAAAtB,EAAK,OAAL,YAAAsB,EAAW,cAAaQ,EAAA9B,EAAK,OAAL,YAAA8B,EAAW,KAC3C,CACH,CAAC,EAED,MAAMC,EAAWlB,EAAI,CAAC,EAEhBmB,EAAOP,EAAS,IACH,CACf,CACE,KAAM,WACN,MAAO,GAAG,UAAU,EACpB,KAAMQ,EACP,EACD,CACE,KAAM,SACN,MAAO,GAAG,QAAQ,EAClB,KAAMC,EACP,EACD,CACE,KAAM,WACN,MAAO,GAAG,UAAU,EACpB,KAAMC,EACP,EACD,CACE,KAAM,QACN,MAAO,GAAG,OAAO,EACjB,KAAMC,EACN,UAAW,IAAMC,EAAY,KAC9B,EACD,CACE,KAAM,QACN,MAAO,GAAG,OAAO,EACjB,KAAMC,EACP,EACD,CACE,KAAM,QACN,MAAO,GAAG,OAAO,EACjB,KAAMC,EACP,EACD,CACE,KAAM,WACN,MAAO,GAAG,UAAU,EACpB,KAAMC,GACN,UAAW,IAAMC,GAAgB,KAClC,CACF,EACiB,OAAQC,GAASA,EAAI,UAAYA,EAAI,YAAc,EAAK,CAC3E,EAEDC,GAAMX,EAAOd,GAAU,CACrB,GAAIA,GAASxB,EAAM,OAAO,QAAS,CACjC,IAAIkD,EAAQ1B,EAAM,UACfwB,GAAQA,EAAI,KAAK,YAAa,IAAKhD,EAAM,OAAO,QAAQ,YAAa,CACvE,EACGkD,IAAU,KACZb,EAAS,MAAQa,EAEpB,CACH,CAAC,EAED,SAASC,GAAaC,EAAM,CAC1B,IAAIC,EAAOD,EAAK,KAAK,MAAM,GAAG,EAAE,IAAK,EAAC,YAAa,EACnD,GAAI,CAAC,CAAC,MAAO,MAAO,MAAM,EAAE,SAASC,CAAI,EACvC,OAAO,GAAG,qCAAqC,CAEnD,CAEA,MAAMC,EAAe/C,EAAe,CAClC,IAAK,iCACL,MAAO,CAAC,eAAgBH,EAAM,MAAM,EACpC,OAAQ,CAAE,QAAS,WAAY,KAAMA,EAAM,MAAQ,EACnD,KAAM,EACR,CAAC,EAED,SAASM,EAAY6C,EAAM/B,EAAOC,EAAU,CAC1CH,EAAWiC,EAAM/B,EAAO,IAAM,CAC5BlB,EAAK,KAAKiD,CAAI,EAAI/B,EAClBC,GAAA,MAAAA,GACJ,CAAG,CACH,CAEA,eAAeb,GAAW2C,EAAM,CAC9B,MAAM1C,EAAK,uBAAwB,CACjC,QAAS,WACT,KAAA0C,CACJ,CAAG,EACDrD,EAAO,KAAK,CAAE,KAAM,OAAO,CAAE,CAC/B,CAGA,MAAMsD,EAAyBrC,EAAI,EAAK,EAClCsC,EAAyBtC,EAAI,EAAK,EAClCuC,EAA8BvC,EAAI,EAAK,EAEvCwC,EAAkBxC,EAAI,EAAE,EACxByC,EAAuBzC,EAAI,EAAE,EAEnC,eAAe0C,EAAcC,EAAS,CACpC,IAAIC,EAAe,GAEnB,GAAIN,EAAuB,OAAS,CAACE,EAAgB,MAAO,CAC1DhD,EAAY,CACV,MAAO,GAAG,OAAO,EACjB,KAAM,GAAG,mCAAmC,EAC5C,KAAM,IACN,YAAa,cACnB,CAAK,EACD,MACD,CAED,GAAI+C,EAA4B,OAAS,CAACE,EAAqB,MAAO,CACpEjD,EAAY,CACV,MAAO,GAAG,OAAO,EACjB,KAAM,GAAG,wCAAwC,EACjD,KAAM,IACN,YAAa,cACnB,CAAK,EACD,MACD,CAkBD,GAhBI8C,EAAuB,OAASE,EAAgB,QAClDrD,EAAK,KAAK,WAAahB,EAAiBqE,EAAgB,KAAK,EAAE,WAC/DrD,EAAK,KAAK,WAAahB,EAAiBqE,EAAgB,KAAK,EAAE,WAC/DrD,EAAK,KAAK,UAAYhB,EAAiBqE,EAAgB,KAAK,EAAE,UAC9DrD,EAAK,KAAK,SAAWhB,EAAiBqE,EAAgB,KAAK,EAAE,SAC7DrD,EAAK,KAAK,UAAYhB,EAAiBqE,EAAgB,KAAK,EAAE,UAC9DF,EAAuB,MAAQ,GAC/BM,EAAe,IAGbL,EAA4B,OAASE,EAAqB,QAC5DtD,EAAK,KAAK,aAAesD,EAAqB,MAC9CF,EAA4B,MAAQ,GACpCK,EAAe,IAGbA,EACFzC,EACE,CACE,WAAYhB,EAAK,KAAK,WACtB,WAAYA,EAAK,KAAK,WACtB,UAAWA,EAAK,KAAK,UACrB,SAAUA,EAAK,KAAK,SACpB,UAAWA,EAAK,KAAK,UACrB,aAAcA,EAAK,KAAK,YACzB,EACD,GACA,IAAMuD,EAAc,EAAI,CACzB,EACDL,EAAuB,MAAQ,OAC1B,CACL,IAAIQ,EAAO,MAAMnD,EACf,qDACA,CACE,KAAMP,EAAK,KAAK,IACjB,CACF,EACG0D,IACFC,GAAQ,sBAAsB,EAC1BH,IACF,MAAMrE,GAAc,OAAQ,EAC5B,MAAMF,GAAS,OAAQ,GAEzBW,EAAO,KAAK,CAAE,KAAM,OAAQ,OAAQ,CAAE,OAAQ8D,CAAI,EAAI,EAEzD,CACH,CAEA,MAAME,EAAa/C,EAAI,IAAI,EAE3B,SAASgD,IAAe,CACtBD,EAAW,MAAM,SAAS,KAAO,EACnC"}