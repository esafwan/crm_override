{"version":3,"file":"MobileNotification-fc650f92.js","sources":["../../../../frontend/src/pages/MobileNotification.vue"],"sourcesContent":["<template>\n  <LayoutHeader>\n    <template #left-header>\n      <Breadcrumbs\n        :items=\"[\n          { label: __('Notifications'), route: { name: 'Notifications' } },\n        ]\"\n      />\n    </template>\n    <template #right-header>\n      <Tooltip :text=\"__('Mark all as read')\">\n        <div>\n          <Button\n            :label=\"__('Mark all as read')\"\n            @click=\"() => notificationsStore().mark_as_read.reload()\"\n          >\n            <template #prefix>\n              <MarkAsDoneIcon class=\"h-4 w-4\" />\n            </template>\n          </Button>\n        </div>\n      </Tooltip>\n    </template>\n  </LayoutHeader>\n  <div class=\"flex flex-col overflow-hidden\">\n    <div\n      v-if=\"notificationsStore().allNotifications?.length\"\n      class=\"divide-y overflow-y-auto text-base\"\n    >\n      <RouterLink\n        v-for=\"n in notificationsStore().allNotifications\"\n        :key=\"n.comment\"\n        :to=\"getRoute(n)\"\n        class=\"flex cursor-pointer items-start gap-3 px-2.5 py-3 hover:bg-gray-100\"\n        @click=\"mark_as_read(n.comment || n.notification_type_doc)\"\n      >\n        <div class=\"mt-1 flex items-center gap-2.5\">\n          <div\n            class=\"size-[5px] rounded-full\"\n            :class=\"[n.read ? 'bg-transparent' : 'bg-gray-900']\"\n          />\n          <WhatsAppIcon v-if=\"n.type == 'WhatsApp'\" class=\"size-7\" />\n          <UserAvatar v-else :user=\"n.from_user.name\" size=\"lg\" />\n        </div>\n        <div>\n          <div v-if=\"n.notification_text\" v-html=\"n.notification_text\" />\n          <div v-else class=\"mb-2 space-x-1 leading-5 text-gray-600\">\n            <span class=\"font-medium text-gray-900\">\n              {{ n.from_user.full_name }}\n            </span>\n            <span>\n              {{ __('mentioned you in {0}', [n.reference_doctype]) }}\n            </span>\n            <span class=\"font-medium text-gray-900\">\n              {{ n.reference_name }}\n            </span>\n          </div>\n          <div class=\"text-sm text-gray-600\">\n            {{ __(timeAgo(n.creation)) }}\n          </div>\n        </div>\n      </RouterLink>\n    </div>\n    <div v-else class=\"flex flex-1 flex-col items-center justify-center gap-2\">\n      <NotificationsIcon class=\"h-20 w-20 text-gray-300\" />\n      <div class=\"text-lg font-medium text-gray-500\">\n        {{ __('No new notifications') }}\n      </div>\n    </div>\n  </div>\n</template>\n<script setup>\nimport LayoutHeader from '@/components/LayoutHeader.vue'\nimport WhatsAppIcon from '@/components/Icons/WhatsAppIcon.vue'\nimport MarkAsDoneIcon from '@/components/Icons/MarkAsDoneIcon.vue'\nimport NotificationsIcon from '@/components/Icons/NotificationsIcon.vue'\nimport UserAvatar from '@/components/UserAvatar.vue'\nimport { notificationsStore } from '@/stores/notifications'\nimport { globalStore } from '@/stores/global'\nimport { timeAgo } from '@/utils'\nimport { Breadcrumbs, Tooltip } from 'frappe-ui'\nimport { onMounted, onBeforeUnmount } from 'vue'\n\nconst { $socket } = globalStore()\n\nfunction mark_as_read(doc) {\n  notificationsStore().mark_doc_as_read(doc)\n}\n\nonBeforeUnmount(() => {\n  $socket.off('crm_notification')\n})\n\nonMounted(() => {\n  $socket.on('crm_notification', () => {\n    notificationsStore().notifications.reload()\n  })\n})\n\nfunction getRoute(notification) {\n  let params = {\n    leadId: notification.reference_name,\n  }\n  if (notification.route_name === 'Deal') {\n    params = {\n      dealId: notification.reference_name,\n    }\n  }\n  return {\n    name: notification.route_name,\n    params: params,\n    hash: '#' + notification.comment || notification.notification_type_doc,\n  }\n}\n</script>\n"],"names":["$socket","globalStore","mark_as_read","doc","notificationsStore","onBeforeUnmount","onMounted","getRoute","notification","params"],"mappings":"w9BAmFA,KAAM,CAAE,QAAAA,CAAS,EAAGC,EAAa,EAEjC,SAASC,EAAaC,EAAK,CACzBC,EAAoB,EAAC,iBAAiBD,CAAG,CAC3C,CAEAE,EAAgB,IAAM,CACpBL,EAAQ,IAAI,kBAAkB,CAChC,CAAC,EAEDM,EAAU,IAAM,CACdN,EAAQ,GAAG,mBAAoB,IAAM,CACnCI,EAAoB,EAAC,cAAc,OAAQ,CAC/C,CAAG,CACH,CAAC,EAED,SAASG,EAASC,EAAc,CAC9B,IAAIC,EAAS,CACX,OAAQD,EAAa,cACtB,EACD,OAAIA,EAAa,aAAe,SAC9BC,EAAS,CACP,OAAQD,EAAa,cACtB,GAEI,CACL,KAAMA,EAAa,WACnB,OAAQC,EACR,KAAM,IAAMD,EAAa,SAAWA,EAAa,qBAClD,CACH"}